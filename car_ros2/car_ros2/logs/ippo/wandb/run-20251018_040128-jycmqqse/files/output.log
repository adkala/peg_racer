/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/vec_monitor.py:44: UserWarning: The environment is already wrapped with a `Monitor` wrapperbut you are wrapping it with a `VecMonitor` wrapper, the `Monitor` statistics will beoverwritten by the `VecMonitor` ones.
  warnings.warn(
Logging to ./logs/ippo/car0
Using cpu device
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/vec_monitor.py:44: UserWarning: The environment is already wrapped with a `Monitor` wrapperbut you are wrapping it with a `VecMonitor` wrapper, the `Monitor` statistics will beoverwritten by the `VecMonitor` ones.
  warnings.warn(
Logging to ./logs/ippo/car1
Using cpu device
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/gym/logger.py:34: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize("%s: %s" % ("WARN", msg % args), "yellow"))
/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/vec_monitor.py:44: UserWarning: The environment is already wrapped with a `Monitor` wrapperbut you are wrapping it with a `VecMonitor` wrapper, the `Monitor` statistics will beoverwritten by the `VecMonitor` ones.
  warnings.warn(
Logging to ./logs/ippo/car2
Using cpu device
[2KTraceback (most recent call last):â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
[2K  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/train_ippo.py", line 160, in 0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
<module>
    main()
[2K  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/train_ippo.py", line 157, in main [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
    train_ippo_selfplay()
[2K  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/train_ippo.py", line 131, in 0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
train_ippo_selfplay
    m0.learn(total_timesteps=chunk, reset_num_timesteps=False, progress_bar=True, callback=cb0)
[2K  File [0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/ppo/ppo.py", line
311, in learn
    return super().learn(
[2K  File [0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/on_policy_a
lgorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer,
n_rollout_steps=self.n_steps)
[2K  File [0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/on_policy_a
lgorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
[2K  File [0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/bas
e_vec_env.py", line 222, in step
    return self.step_wait()
[2K  File [0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/vec
_monitor.py", line 76, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
[2K  File [0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/dum
my_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] =
self.envs[env_idx].step(  # type: ignore[assignment]
[2K  File [0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/monitor.py"
, line 94, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
[2K  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/old2gym.py", line 34, in step0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
    out = self._env.step(action)
[2K  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/opp_train_env.py", line 160, in [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
step
    oa, *_ = getattr(self, id_a).step(self.opponents[id_a](self._rl_obs(fa, fb, self._feats(oc, wpc))))
[2K  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/opp_train_env.py", line 66, in  [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
_feats
    tgt, _, s, e = wp.generate(jnp.array(obs[:5]), dt=DT, mu_factor=1.0, body_speed=vx)
[2K  File [0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
"/Users/sanikabharvirkar/Documents/alpha-RACER/car_dynamics/car_dynamics/controllers_jax/waypoint.py",
line 263, in generate
    psi = jnp.arctan2(pos_next[1] - pos[1], pos_next[0] - pos[0])
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/array.py", line 336, [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
in __getitem__
    return lax_numpy._rewriting_take(self, idx)
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/numpy/lax_numpy.py", [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
line 6579, in _rewriting_take
    if (result := _attempt_rewriting_take_via_slice(arr, idx, mode)) is not None:
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/numpy/lax_numpy.py", [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
line 6556, in _attempt_rewriting_take_via_slice
    arr = lax.slice(
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/lax/slicing.py", m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
line 108, in slice
    return slice_p.bind(operand, start_indices=tuple(start_indices),
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/core.py", line 416,  [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/core.py", line 420,  [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/core.py", line 921,  [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
in process_primitive
    return primitive.impl(*tracers, **params)
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/lax/slicing.py", m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
line 1169, in _slice_impl
    return dispatch.apply_primitive(dynamic_slice_p, x, *start_indices,
[2K  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/dispatch.py", line [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
87, in apply_primitive
    outs = fun(*args)
[2KKeyboardInterrupt;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
[2KTraceback (most recent call last):â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:04[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/train_ippo.py", line 160, in
<module>
    main()
  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/train_ippo.py", line 157, in main
    train_ippo_selfplay()
  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/train_ippo.py", line 131, in
train_ippo_selfplay
    m0.learn(total_timesteps=chunk, reset_num_timesteps=False, progress_bar=True, callback=cb0)
  File
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/ppo/ppo.py", line
311, in learn
    return super().learn(
  File
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/on_policy_a
lgorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer,
n_rollout_steps=self.n_steps)
  File
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/on_policy_a
lgorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/bas
e_vec_env.py", line 222, in step
    return self.step_wait()
  File
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/vec
_monitor.py", line 76, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/dum
my_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] =
self.envs[env_idx].step(  # type: ignore[assignment]
  File
"/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/monitor.py"
, line 94, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/old2gym.py", line 34, in step
    out = self._env.step(action)
  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/opp_train_env.py", line 160, in
step
    oa, *_ = getattr(self, id_a).step(self.opponents[id_a](self._rl_obs(fa, fb, self._feats(oc, wpc))))
  File "/Users/sanikabharvirkar/Documents/alpha-RACER/car_ros2/car_ros2/opp_train_env.py", line 66, in
_feats
    tgt, _, s, e = wp.generate(jnp.array(obs[:5]), dt=DT, mu_factor=1.0, body_speed=vx)
  File
"/Users/sanikabharvirkar/Documents/alpha-RACER/car_dynamics/car_dynamics/controllers_jax/waypoint.py",
line 263, in generate
    psi = jnp.arctan2(pos_next[1] - pos[1], pos_next[0] - pos[0])
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/array.py", line 336,
in __getitem__
    return lax_numpy._rewriting_take(self, idx)
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/numpy/lax_numpy.py",
line 6579, in _rewriting_take
    if (result := _attempt_rewriting_take_via_slice(arr, idx, mode)) is not None:
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/numpy/lax_numpy.py",
line 6556, in _attempt_rewriting_take_via_slice
    arr = lax.slice(
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/lax/slicing.py",
line 108, in slice
    return slice_p.bind(operand, start_indices=tuple(start_indices),
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/core.py", line 416,
in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/core.py", line 420,
in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/core.py", line 921,
in process_primitive
    return primitive.impl(*tracers, **params)
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/lax/slicing.py",
line 1169, in _slice_impl
    return dispatch.apply_primitive(dynamic_slice_p, x, *start_indices,
  File "/Users/sanikabharvirkar/Library/Python/3.9/lib/python/site-packages/jax/_src/dispatch.py", line
87, in apply_primitive
    outs = fun(*args)
KeyboardInterrupt
[2K[35m   0%[0m [38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m16/10,000 [0m [ [33m0:00:05[0m < [36m0:35:37[0m , [31m5 it/s[0m ]
